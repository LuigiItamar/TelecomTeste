<h5>{{ model.id ? 'Editar Fatura' : 'Nova Fatura' }}</h5>

<div *ngIf="erro" class="alert alert-danger">{{ erro }}</div>

<form #form="ngForm" (ngSubmit)="onSubmit()">
  <div class="mb-3">
    <label for="contratoId" class="form-label">Contrato</label>
    <select
      id="contratoId"
      name="contratoId"
      class="form-select"
      required
      [(ngModel)]="model.contratoId"
      #contratoId="ngModel"
    >
      <option value="" disabled>Selecione</option>
      <option *ngFor="let c of contratos" [value]="c.id">{{ c.nomeFilial }} - {{ c.planoContratado }}</option>
    </select>
    <div *ngIf="contratoId.invalid && contratoId.touched" class="text-danger">
      Campo obrigatório
    </div>
  </div>

  <div class="mb-3">
    <label for="dataEmissao" class="form-label">Data de Emissão</label>
    <input
      id="dataEmissao"
      name="dataEmissao"
      type="date"
      class="form-control"
      required
      [(ngModel)]="model.dataEmissao"
      #dataEmissao="ngModel"
    />
    <div *ngIf="dataEmissao.invalid && dataEmissao.touched" class="text-danger">
      Campo obrigatório
    </div>
  </div>

  <div class="mb-3">
    <label for="dataVencimento" class="form-label">Data de Vencimento</label>
    <input
      id="dataVencimento"
      name="dataVencimento"
      type="date"
      class="form-control"
      required
      [(ngModel)]="model.dataVencimento"
      #dataVencimento="ngModel"
    />
    <div *ngIf="dataVencimento.invalid && dataVencimento.touched" class="text-danger">
      Campo obrigatório
    </div>
  </div>

  <div class="mb-3">
    <label for="valorCobrado" class="form-label">Valor Cobrado</label>
    <input
      id="valorCobrado"
      name="valorCobrado"
      type="number"
      class="form-control"
      required
      min="0"
      step="0.01"
      [(ngModel)]="model.valorCobrado"
      #valorCobrado="ngModel"
    />
    <div *ngIf="valorCobrado.invalid && valorCobrado.touched" class="text-danger">
      Campo obrigatório
    </div>
  </div>

  <div class="mb-3">
    <label for="status" class="form-label">Status</label>
    <select
      id="status"
      name="status"
      class="form-select"
      required
      [(ngModel)]="model.status"
      #status="ngModel"
    >
      <option value="" disabled>Selecione</option>
      <option *ngFor="let s of statusList" [value]="s">{{ s }}</option>
    </select>
    <div *ngIf="status.invalid && status.touched" class="text-danger">
      Campo obrigatório
    </div>
  </div>

  <button
    type="submit"
    class="btn btn-primary"
    [disabled]="form.invalid || carregando"
  >
    Salvar
  </button>
  <button
    type="button"
    class="btn btn-secondary ms-2"
    (click)="cancelar()"
    [disabled]="carregando"
  >
    Cancelar
  </button>
</form> 